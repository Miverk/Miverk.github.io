<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="追求卓越无止境,勿忌别人品头足">
<meta property="og:type" content="website">
<meta property="og:title" content="Michealwu">
<meta property="og:url" content="http://michealwu.tech/index.html">
<meta property="og:site_name" content="Michealwu">
<meta property="og:description" content="追求卓越无止境,勿忌别人品头足">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Michealwu">
<meta name="twitter:description" content="追求卓越无止境,勿忌别人品头足">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://michealwu.tech/"/>





  <title>Michealwu</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Michealwu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">原谅我这一生不羁放纵爱自由</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/androidpoint/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/androidpoint/" itemprop="url">一些常用的Android技术文章</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-16T16:10:50+08:00">
                2018-01-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="FFmpeg4Android移植封装"><a href="#FFmpeg4Android移植封装" class="headerlink" title="FFmpeg4Android移植封装"></a>FFmpeg4Android移植封装</h2><p><a href="https://www.jianshu.com/p/ceb3b129d15f" title="ffpmeg" target="_blank" rel="noopener">https://www.jianshu.com/p/ceb3b129d15f</a></p>
<h2 id="Gradle模块化配置：让你的gradle代码控制在100行以内"><a href="#Gradle模块化配置：让你的gradle代码控制在100行以内" class="headerlink" title="Gradle模块化配置：让你的gradle代码控制在100行以内"></a>Gradle模块化配置：让你的gradle代码控制在100行以内</h2><p><a href="https://www.jianshu.com/p/8d52afc1057d" target="_blank" rel="noopener">https://www.jianshu.com/p/8d52afc1057d</a></p>
<h2 id="Android借助Python实现自动打包上传fir"><a href="#Android借助Python实现自动打包上传fir" class="headerlink" title="Android借助Python实现自动打包上传fir"></a>Android借助Python实现自动打包上传fir</h2><p><a href="https://www.jianshu.com/p/0ec4c4e132e7" target="_blank" rel="noopener">https://www.jianshu.com/p/0ec4c4e132e7</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/gradlemodule/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/gradlemodule/" itemprop="url">Gradle模块化配置：让你的gradle代码控制在100行以内</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-10T16:10:50+08:00">
                2018-01-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>我们知道，Android Studio是利用gradle进行构建的，我们经常接触到的gradle脚本是build.gradle，build.gradle有两个，一个在project下，一个是在app目录下，随着项目的迭代，我们会在app目录下的gradle中添加很多依赖，project下的gradle却不会发生很大的变化，所以会导致app下面的gradle文件越来越大，有时候查找对应的方法以及task非常不方便，尤其是在集成了tinker热修复之后，app下面的gradle已经达到了将近1000多行，最近刚好有时间认真研究了一下gradle，确切地说是groovy，然后通过脚本依赖实现了gradle解耦，成功的把app目录下的gradle代码控制在100行以内。</p>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="常见配置"><a href="#常见配置" class="headerlink" title="常见配置"></a>常见配置</h2><p>通常的做法是在project目录下新建一个config.gradle文件，如下：</p>
<pre><code>ext {
    android = [
                compileSdkVersion: 25,
                buildToolsVersion: &quot;25.0.3
]
    supportLibrary = &quot;25.4.0&quot;
    tinkerVerison = &quot;1.9.1&quot;
    dependencies = [
      &quot;multidex&quot;   : &quot;com.android.support:multidex:1.0.1&quot;,
      &quot;okhttp3&quot;   : &quot;com.squareup.okhttp3:okhttp:3.9.0&quot;
}
</code></pre><p>然后在project下的build.gradle文件中引用</p>
<pre><code>apply from: &quot;config.gradle&quot;
</code></pre><p>再接着在app目录下的build.gradle中获取并使用</p>
<pre><code>apply plugin: &apos;com.android.application&apos;
apply from: &quot;package.gradle&quot;

def cfg = rootProject.ext.android
def librarys = rootProject.ext.dependencies

android {
    compileSdkVersion cfg.compileSdkVersion
    buildToolsVersion cfg.buildToolsVersion
    dexOptions {
        jumboMode = true
    }
//此处省略一万行代码
}
dependencies {
    compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;)
    compile librarys[&quot;multidex&quot;]
    compile librarys[&quot;okhttp3&quot;]
//此处省略一万行代码
}
</code></pre><p>这种方式能够将我们的gradle统一进行管理，虽然并不能减少app的目录下的build.gradle的代码量之前，但是觉得够用了，本身对基于groovy的gradle不是很熟，虽然随着项目迭代，app目录下的build.gradle代码量越来越大，尤其是当项目集成了tinker之后，而后集成了<a href="https://github.com/mcxiaoke/packer-ng-plugin" title="packer" target="_blank" rel="noopener">packer-ng-plugin</a>打包，以及加入了一些自定义的Task之后，代码会显得非常臃肿，有时候改一个东西，需要找很久，由于对groovy不是很熟，在网上也看过一些文章，基本上都是在介绍gradle的基本知识以及依赖统一管理，加上在gradle里面写代码没有提示，一度让我以为这可能就是build.gradle的最终版了，直到最近项目刚上线，稍微有点空闲，然后决定彻底简化一下gradle代码。</p>
<h2 id="url优化"><a href="#url优化" class="headerlink" title="url优化"></a>url优化</h2><p>按照config的配置，一般来讲，我们开发的时候至少会有两个服务器地址，正式跟测试，为了统一管理，先是写死在buildType里面的</p>
<pre><code> buildTypes {
        release {
            minifyEnabled true
            shrinkResources true
            buildConfigField &quot;String&quot;, &quot;AlphaUrl&quot;, &quot;\&quot;releaseUrl1\&quot;&quot;
//          buildConfigField &quot;String&quot;, &quot;AlphaUrl&quot;, &quot;\&quot;releaseUrl2\&quot;&quot;
        }
        debug {
            minifyEnabled true
              buildConfigField &quot;String&quot;, &quot;AlphaUrl&quot;, &quot;\&quot;debugUrl1\&quot;&quot;
//            buildConfigField &quot;String&quot;, &quot;AlphaUrl&quot;, &quot;\&quot;debugUrl2/\&quot;&quot;

        }
    }
</code></pre><p>当我们的服务器地址只有一个正式的或者一个测试的时候，这样写完全OK的，但是如果是有多个地址的话，你每切换一次，都需要重新同步一下，还有就是，多人协作开发的时候，每次从Git服务器上面更新代码，只要更新到app目录下的gradle，都是需要重新同步的，参照config的配置，我们如果是引用的话就每次只需要读取引用的那个url，切换只需要修改config中的代码就可以了，下面是进行的优化：<br>在config中添加代码</p>
<pre><code>    url = [
  &quot;debug&quot;  : &quot;debugUrl1&quot;,
//&quot;debug&quot;  : &quot;debugUrl2&quot;,    
//&quot;debug&quot;  : &quot;debugUrl3&quot;,
   &quot;release&quot;: &quot;releaseUrl1&quot;,
// &quot;release&quot;: &quot;releaseUrl2&quot;

    ]
</code></pre><p>重新引用</p>
<pre><code>//获取
def url = rootProject.ext.url
//使用
//debug
buildConfigField &quot;String&quot;, &quot;AlphaUrl&quot;, &quot;\&quot;${url[&quot;debug&quot;]}\&quot;&quot;
//release
buildConfigField &quot;String&quot;, &quot;AlphaUrl&quot;, &quot;\&quot;${url[&quot;release&quot;]}\&quot;&quot;
</code></pre><h2 id="依赖优化"><a href="#依赖优化" class="headerlink" title="依赖优化"></a>依赖优化</h2><p>先看一看之前的代码</p>
<pre><code>dependencies {
 compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;)
 compile librarys[&quot;multidex&quot;]
 compile librarys[&quot;supportAppcompat&quot;]
 //此处省略一万行代码
</code></pre><p>实际上library就是一个Map,其实这句代码转化成Java就是</p>
<pre><code>compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;)
HashMap&lt;String,String&gt; hashMap=new HashMap&lt;&gt;();
compile hashMap.get(&quot;multidex&quot;)
compile hashMap.get(&quot;supportAppcompat&quot;)
</code></pre><p>其实可能你也知道了，实际上我们完全可以写一个循环来简化这些代码，就跟HashMap的遍历一样</p>
<pre><code>dependencies {
compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;)
librarys.each { k, v -&gt; compile v }
</code></pre><p>}</p>
<h2 id="模块化配置"><a href="#模块化配置" class="headerlink" title="模块化配置"></a>模块化配置</h2><p>在我们进行常规的gradle配置中，我们并没有在project下的build目录添加很多代码，只是新建了一个config.gradle文件，然后再project目录下添加了一行依赖，所以就能够调用config中的代码，同样的，我们也可以把tinker，packer-ng-plugin，以及自定义task的配置文件用一个gradle文件进行配置，然后在app的目录下进行引用，实际上就是利用了gradle的插件依赖。</p>
<h2 id="tinker配置"><a href="#tinker配置" class="headerlink" title="tinker配置"></a>tinker配置</h2><p>首先在app的目录下新建一个tinker.grale配置文件，为什么是tinker目录下，因为tinker的运行需要依赖’com.android.application’这个插件，所以必须放在这个目录下，然后复制粘贴tinker的配置代码，注意不要忘记修改tinker的id，我是在project目录下统一进行配置的tinker，所以只需要调用config中的代码</p>
<p>//此处省略一万行代码</p>
<p>def getTinkerIdValue() {<br>    return rootProject.ext.tinker.id</p>
<p>}<br>//此处省略一万行代码</p>
<p>然后在app下面的build.gradle中进行引用,注意看一下这行代码的位置，不要放在最开始，因为在依赖tinker.gradle文件的时候，不然你是打不了tinker的补丁的，tinker需要读取application的一些信息，放在buildTypes 之后，当时我也是调试了好久。</p>
<pre><code>apply plugin: &apos;com.android.application&apos;
def cfg = rootProject.ext.android
def librarys = rootProject.ext.Dependencies
def tinker = rootProject.ext.tinker
def url = rootProject.ext.url

 buildTypes {
  //此处省略一万行代码
}
apply from: &quot;tinker.gradle&quot;
</code></pre><p>到此，tinker就可以使用了，下面继续配置packer的gradle</p>
<h2 id="packer配置"><a href="#packer配置" class="headerlink" title="packer配置"></a>packer配置</h2><p>新建package.gradle文件</p>
<pre><code>apply plugin: &apos;packer&apos;
packer {
    archiveNameFormat = &apos;${buildType}-v${versionName}-${channel}&apos;
    archiveOutput = new File(project.rootProject.buildDir, &quot;apks&quot;)
    channelList = [&apos;xiaomi&apos;,&apos;meizu&apos;]
}
}
</code></pre><p>在app下的build.gradle中添加依赖</p>
<pre><code>apply plugin: &apos;com.android.application&apos;
apply from: &quot;package.gradle&quot;
</code></pre><h2 id="task配置"><a href="#task配置" class="headerlink" title="task配置"></a>task配置</h2><p>虽然Android Studio的application自带了很多task，但是并不能满足我们有些需求，比如我需要用Python将测试包上传至fir，就需要自定义task，所以我也打算把这部分给分离出来，新建upload.gradle</p>
<pre><code>ext {
   //此处省略一万行代码
    startUpload = this.&amp;startUpload
}
//上传至fir
def startUpload() {
 //此处省略一万行代码
}
</code></pre><p>在project中引用</p>
<pre><code>apply from: &quot;upload.gradle&quot;
</code></pre><p>在app的build.gradle中可以直接调用</p>
<pre><code>task toFir &lt;&lt; {
    startUpload()
}
</code></pre><p>toFir &lt;&lt;，其实是gradle的语法，如果不加&lt;&lt;的话，每次编译的时候都会执行这个task，加了&lt;&lt;，只有执行这个task的时候才会执行里面的代码</p>
<p><img src="https://i.imgur.com/KoXX8dT.png" alt="grad"></p>
<p>只有81行，这样一来，调试就很轻松了，哪个脚本除了问题，就直接去调试相应的脚本就好了，不用在自己的gradle里面改来改去。</p>
<h1 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h1><h2 id="tinker-测试"><a href="#tinker-测试" class="headerlink" title="tinker 测试"></a>tinker 测试</h2><p>运行命令gradlew tinkerpatchDebug或者打开右侧的可视化工具栏点击tinker下的tinkerpatchDebug，运行测试，运行结果：</p>
<pre><code>Result: final signed patch result: G:\Note\ChuangMei\app\build\outputs\tinkerPatch\debug\patch_signed.apk, size=2110
Result: final signed with 7zip patch result: G:\Note\ChuangMei\app\build\outputs\tinkerPatch\debug\patch_signed_7zip.apk, size=2439
Warning: patch_signed_7zip.apk is bigger than patch_signed.apk 329 byte, you should choose patch_signed.apk at these time!
Tinker patch done, total time cost: 8.806000s
Tinker patch done, you can go to file to find the output G:\Note\ChuangMei\app\build\outputs/tinkerPatch/debug
-----------------------Tinker patch end-------------------------
BUILD SUCCESSFUL in 3m 16s
</code></pre><h2 id="packer测试"><a href="#packer测试" class="headerlink" title="packer测试"></a>packer测试</h2><p>运行命令gradlew clean apkDebug运行测试，运行结果：</p>
<pre><code>&gt; Task :app:apkDebug
============================================================
PackerNg - https://github.com/mcxiaoke/packer-ng-plugin
============================================================
Variant: debug
Input: G:\Note\ChuangMei\app\build\outputs\apk\app-debug.apk
Output: G:\Note\ChuangMei\build\apks
Channels: [xiaomi meizu]
Generating: debug-v1.6.3-xiaomi.apk
Generating: debug-v1.6.3-meizu.apk
Outputs: G:\Note\ChuangMei\build\apks
</code></pre><h2 id="task测试"><a href="#task测试" class="headerlink" title="task测试"></a>task测试</h2><p>运行命令 gradlew task toFir，运行结果:</p>
<pre><code>开始上传至fir
http://api.fir.im/apps
success_apk:{&quot;is_completed&quot;:true}
success_icon:{&quot;is_completed&quot;:true}
上传结束 with value 0
</code></pre><h1 id="几点说明"><a href="#几点说明" class="headerlink" title="几点说明"></a>几点说明</h1><h2 id="gradle所放位置"><a href="#gradle所放位置" class="headerlink" title="gradle所放位置"></a>gradle所放位置</h2><p>为什么有的是放在project目录下，有的是放在app的目录下，因为gradle引用默认的是当前路径，这样放我引用的时候就不需要去配置所引用的gradle路径，当然如果你原因放置在同一个目录下面也是OK的，只需要在apply的时候加上引用的path即可。</p>
<h2 id="引用位置"><a href="#引用位置" class="headerlink" title="引用位置"></a>引用位置</h2><p>为什么有的引用是放在头部，有的引用需要放置在中间，这个取决于引用的插件是否需要读取application的配置信息，如果是tinker，必须放置在中间，因为它生成patch包需要获取很多application信息，如果是packer打包的话，则不需要，这个需要格外留意一下，不然会有很多莫名其妙的错误。</p>
<h2 id="方法调用"><a href="#方法调用" class="headerlink" title="方法调用"></a>方法调用</h2><p>在同一个gradle脚本里面，方法调用是很简单的，但是当我们有多个gradle脚本的时候，如何相互调用彼此的方法呢，其实我之前想优化的时候，也是卡在这里，因为属性调用很简单，gradle提供了ext，所以我们可以很容易的获取其他gradle的属性，如果我们现在有两个gradle，一个是first.gradle，一个是second.gradle，我想在second.gradle里面调用first.gradle中的方法，应该怎么做呢？<br>只需要在first.gradle中进行如下配置</p>
<pre><code>ext{ 
    test= this.&amp;test
 } 
    def  test(){  
       println(&quot;我被调用了&quot;)
}  
</code></pre><p>然后在second.gradle中进行配置</p>
<pre><code>//直接调用
   test()
//通过task调用
task CustomTask &lt;&lt; {
    test()
}
</code></pre><h1 id="关于代码"><a href="#关于代码" class="headerlink" title="关于代码"></a>关于代码</h1><h2 id="package"><a href="#package" class="headerlink" title="package"></a>package</h2><p>需要配置签名，在keystore.properties中进行配置，可以进行多渠道打包</p>
<h2 id="tinker"><a href="#tinker" class="headerlink" title="tinker"></a>tinker</h2><p>为了保证对gradle进行模块化分离不影响项目的构建，所以我都是用自己的真实项目进行构建的，因为简单的Demo很难模拟真实项目中的构建环境，所以demo中我只提供了gradle的配置文件，没有进行tinker的配置，但是已经对tinker进行了模块化分离。</p>
<h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p>上传至fir的代码是利用Python脚本进行上传的，需要配置Python环境以及安装requests库，感兴趣的话可以查看一下我之前的文章<a href="https://www.jianshu.com/p/0ec4c4e132e7" title="ac" target="_blank" rel="noopener">Python(一)Android借助Python实现自动打包上传fir</a></p>
<p><a href="https://github.com/wustor/GradleModule" title="aabbcc" target="_blank" rel="noopener">代码下载</a></p>
<p>—-转自<a href="https://www.jianshu.com/p/8d52afc1057d" target="_blank" rel="noopener">https://www.jianshu.com/p/8d52afc1057d</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/hexoblog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/hexoblog/" itemprop="url">Hexo搭建博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-09T17:42:50+08:00">
                2018-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Hexo搭建博客"><a href="#Hexo搭建博客" class="headerlink" title="Hexo搭建博客"></a>Hexo搭建博客</h1><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h2><pre><code>1.安装npm，git,hexo(本博客只安装hexo，npm和git自行安装)
2.有自己的github账号，（本人github账号是Miverk，之后会一直用这个账号来发布）
3.购买域账号（我是在阿里云上购买的一个.tech的账号）
</code></pre><h2 id="2-安装hexo-和-建站"><a href="#2-安装hexo-和-建站" class="headerlink" title="2.安装hexo 和 建站"></a>2.安装hexo 和 建站</h2><p>安装hexo</p>
<blockquote>
<p>$ npm install -g hexo-cli</p>
</blockquote>
<pre><code>如果碰到安装不了，可能是有些公司禁止了一些网站，可以设置代理
</code></pre><blockquote>
<p>$ npm config set proxy <a href="http://server:port" target="_blank" rel="noopener">http://server:port</a></p>
<p>$ npm config set https-proxy <a href="http://server:port" target="_blank" rel="noopener">http://server:port</a></p>
</blockquote>
<p>安装好hexo后就可以建站了</p>
<p>cd到你自己建的文件夹执行</p>
<blockquote>
<p>hexo init yourname</p>
<p>cd yourname</p>
<p>npm install</p>
</blockquote>
<p>yourname的名字是可以随便取的，hexo建站操作而已参考官方文档：<a href="https://hexo.io/zh-cn/" title="hexo" target="_blank" rel="noopener">https://hexo.io/zh-cn/</a></p>
<p>建完站之后就可以发布了，先发布到本地服务器上看下blog是怎样的</p>
<blockquote>
<p>hexo s</p>
</blockquote>
<p>本地发布好没问题后，然后修改_config.yml文件，让博客关联到Github上的Github Pages</p>
<pre><code>deploy:
type: git
repo: https://github.com/Miverk/Miverk.github.io.git
branch: master
</code></pre><p>修改完成之后，就可以发布到Github上了</p>
<h2 id="3-发布"><a href="#3-发布" class="headerlink" title="3.发布"></a>3.发布</h2><blockquote>
<p>hexo clean</p>
<p>hexo g</p>
<p>hexo d</p>
</blockquote>
<p>也可以简写命令，参考官网</p>
<blockquote>
<p>hexo d -g</p>
</blockquote>
<p>如果碰到发布时候not found，尝试下这个命令</p>
<blockquote>
<p>npm install hexo-deployer-git –save</p>
</blockquote>
<p>然后再部署看下，是否成功，下面是我部署成功的界面</p>
<p><img src="https://i.imgur.com/OFJZsmk.png" alt="hexo d suceeess"></p>
<h2 id="4-购买域名和域名绑定"><a href="#4-购买域名和域名绑定" class="headerlink" title="4.购买域名和域名绑定"></a>4.购买域名和域名绑定</h2><p>推荐去阿里云上购买一个域名进行绑定，域名的解析添加：</p>
<p><img src="https://i.imgur.com/jK2hpXC.png" alt="aa"></p>
<p>然后在工程的source目录下添加一个CNAME文件。里面填写自己的域名(我的域名：michealwu.tech, 1年9元O(∩_∩)O哈哈~)</p>
<blockquote>
<p>michealwu.tech</p>
</blockquote>
<p>这样整个流程就通了，以后要发布blog，只要在\source_posts文件夹下面创建一个.md的文件就行了。</p>
<h2 id="5-结束语"><a href="#5-结束语" class="headerlink" title="5.结束语"></a>5.结束语</h2><p>虽然github pages免费，但是是国外服务器，国内访问可能会慢一点，单毕竟是免费的。有钱人可以去Node.js支持下。</p>
<p>欢迎大家点击我的博客：<a href="http://michealwu.tech" title="michelawu">http://michealwu.tech</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/freemarker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/freemarker/" itemprop="url">Freemarker解析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-09T14:42:50+08:00">
                2018-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-Freemarker是什么？"><a href="#1-Freemarker是什么？" class="headerlink" title="1. Freemarker是什么？"></a>1. Freemarker是什么？</h2><p>FreeMarker 是一款模板引擎：即一种基于模板、用来生成输出文本(任何来自于 HTML格式的文本用来自动生成源代码)的通用工具。它是为 Java 程序员提供的一个开发包，或者说是一个类库。<br>FreeMarker 不是 Web 开发的应用程序框架。它是一个适用于 Web 应用程序框架中的组件，但是 FreeMarker 引擎本身并不知道 HTTP 协议或 Java  Servlet 的存在。它仅仅来生成文本内容。</p>
<h2 id="2-Freemarker能做什么？"><a href="#2-Freemarker能做什么？" class="headerlink" title="2. Freemarker能做什么？"></a>2. Freemarker能做什么？</h2><p>使用 FreeMarker 作为视图层的组件，是为了给诸如 Struts 这样的 Model 2 应用框架提供现成的解决方案。比如代替Jsp，生成静态的Html等等；<br><a href="http://mvnrepository.com/artifact/org.freemarker/freemarker" title="bb" target="_blank" rel="noopener">http://mvnrepository.com/artifact/org.freemarker/freemarker</a></p>
<p><img src="https://i.imgur.com/PxmQGFZ.png" alt="freeemarker"></p>
<h2 id="3-Javassist是什么？"><a href="#3-Javassist是什么？" class="headerlink" title="3.Javassist是什么？"></a>3.Javassist是什么？</h2><p>Javassist是一款字节码编辑工具，可以直接编辑和生成Java生成的字节码，以达到对.class文件进行动态修改的效果。熟练使用这套工具，可以让Java编程更接近与动态语言编程。</p>
<h2 id="4-Freemarker能做什么？"><a href="#4-Freemarker能做什么？" class="headerlink" title="4. Freemarker能做什么？"></a>4. Freemarker能做什么？</h2><p>最近对一个快速开发的框架很感兴趣，使用这个框架的开发人员采用面向声明的开发模式，异常的简单和方便，而且效率也是原来的好几倍。自己曾经在公司写过些类似的东西，都是通过实体或数据库提供数据结构，模板提供页面或代码结构，生成需要实现的具体页面和代码。但这个框架我搭起来后，在目录文件里找了半天都没看到半点生成的代码和页面，他是如何实现的？</p>
<p>对，主要就是javassist这货的功劳！平时在添加依赖jar包时，总少不了它，其实Javassist是一个动态字节码生成框架，包括支持两种API，Java语言级别和字节码级别。简单的说就是他可以通过配置，在程序运行时，生成临时的java代码，来实现当前需要的特定功能的框架。下面我们来看看如何使用这个强大的框架。</p>
<p><a href="http://mvnrepository.com/artifact/org.javassist/javassist" title="aa" target="_blank" rel="noopener">http://mvnrepository.com/artifact/org.javassist/javassist</a></p>
<p><img src="https://i.imgur.com/1KcYA94.png" alt="javasisit"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/markdown/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/markdown/" itemprop="url">markdownpad2-注册码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-08T17:42:50+08:00">
                2018-01-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="MarkdownPad2-5-2-注册码"><a href="#MarkdownPad2-5-2-注册码" class="headerlink" title="MarkdownPad2.5/2 注册码"></a>MarkdownPad2.5/2 注册码</h2><p>User：</p>
<p>Soar360@live.com</p>
<p>授权：</p>
<pre><code>GBPduHjWfJU1mZqcPM3BikjYKF6xKhlKIys3i1MU2eJHqWGImDHzWdD6xhMNLGVpbP2M5SN6bnxn2kSE8qHqNY5QaaRxmO3YSMHxlv2EYpjdwLcPwfe
TG7kUdnhKE0vVy4RidP6Y2wZ0q74f47fzsZo45JE2hfQBFi2O9Jldjp1mW8HUpTtLA2a5/sQytXJUQl/
QKO0jUQY4pa5CCx20sV1ClOTZtAGngSOJtIOFXK599sBr5aIEFyH0K7H4BoNMiiDMnxt1rD8Vb/ikJdhGMMQr0R4B+L3nWU97eaVPTRKfWGDE8/
eAgKzpGwrQQoDh+nzX1xoVQ8NAuH+s4UcSeQ==
</code></pre><h2 id="测试插入图片"><a href="#测试插入图片" class="headerlink" title="测试插入图片"></a>测试插入图片</h2><p><img src="https://i.imgur.com/40qEPdn.jpg" alt="Test"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/sf-pmd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/sf-pmd/" itemprop="url">sf-pmd-1.3.5 maven 上传流程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-08T14:00:50+08:00">
                2018-01-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="发送私包到服务器"><a href="#发送私包到服务器" class="headerlink" title="发送私包到服务器"></a>发送私包到服务器</h2><pre><code>发布包到私服（项目根目录执行）
mvn clean source:jar deploy -Dmaven.test.skip=true
</code></pre><h2 id="pom文件注意点"><a href="#pom文件注意点" class="headerlink" title="pom文件注意点"></a>pom文件注意点</h2><pre><code>&lt;distributionManagement&gt;
    &lt;repository&gt;
        &lt;id&gt;releases&lt;/id&gt;
        &lt;name&gt;Demo Release Repository&lt;/name&gt;
        &lt;url&gt;http://nexus.sf-express.com/nexus/content/repositories/releases/&lt;/url&gt;
    &lt;/repository&gt;
    &lt;snapshotRepository&gt;
        &lt;id&gt;snapshots&lt;/id&gt;
        &lt;name&gt;Demo Snapshot Repository&lt;/name&gt;
        &lt;url&gt;http://nexus.sf-express.com/nexus/content/repositories/snapshots/&lt;/url&gt;
    &lt;/snapshotRepository&gt;
&lt;/distributionManagement&gt; 

&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;sf-private-reponsitory&lt;/id&gt;
        &lt;name&gt;SF private repository&lt;/name&gt;
        &lt;url&gt;http://nexus.sf-express.com/nexus/content/groups/public/&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre><h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><pre><code>[INFO] --- maven-gpg-plugin:1.6:sign (sign-artifacts) @ sf-pmd ---
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 16.744 s
[INFO] Finished at: 2018-01-05T15:20:11+08:00
[INFO] Final Memory: 24M/323M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-gpg-plugin:1.6:sign (sign-artifacts) on project sf-pmd: Unable to execute gpg command: Error while executing process. Cannot run program &quot;gpg.exe&quot;: CreateProcess error=2, 系统找不到指定的文件。 -&gt; [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
</code></pre><p>出现上述问题，要引入如下标签</p>
<pre><code>&lt;build&gt;
   &lt;pluginManagement&gt;
   &lt;plugins&gt;
      &lt;plugin&gt;&lt;/plugin&gt;
    &lt;/plugins&gt;
    &lt;/pluginManagement&gt;
&lt;/build&gt;
</code></pre><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>记录工作中出现的难题，方便自己查阅。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/adb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/adb/" itemprop="url">adb 常用命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-06T18:00:00+08:00">
                2018-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>输出已经安装的应用</p>
<p>adb shell pm list packages -f</p>
<p>模拟按键输入</p>
<p>adb shell input keyevent</p>
<p>模拟滑动输入</p>
<p>adb shell inputtouchscreen swipe x1 y1 x2 y2</p>
<p>dumpsys activity | gerp “tencent”</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/aa/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/aa/" itemprop="url">RX2.0的详细使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-06T14:42:50+08:00">
                2018-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前言</p>
<p>在上一篇博客中，提到了RxJava的一些比较核心的东西，还有与1.x版本的一些区别！<br>现在我们具体了解一下它的使用！</p>
<p>使用</p>
<p>最基本的的使用</p>
<p>我们知道一个简单的RxJava的应用，需要一个观察者或者订阅者Observer，一个被观察者Observable，最后调用subscribe()方法将两者绑定起来！<br>示例：</p>
<p>//创建观察者或者订阅者<br>Observer<string> observer = new Observer<string>() {<br>    @Override<br>    public void onSubscribe(Disposable d) {<br>    //Disposable是1.x的Subscription改名的，因为Reactive-Streams规范用这个名称，为了避免重复<br>    //这个回调方法是在2.0之后新添加的<br>    //可以使用d.dispose()方法来取消订阅<br>    }</string></string></p>
<pre><code>@Override
public void onNext(String value) {
    Log.e(&quot;onNext&quot;, value);
}

@Override
public void onError(Throwable e) {
    Log.e(&quot;onError&quot;, e.getMessage());
}

@Override
public void onComplete() {
    Log.e(&quot;onComplete&quot;, &quot;complete&quot;);
}
</code></pre><p>};</p>
<p>//创建被观察者<br>Observable observable = Observable.create(new ObservableOnSubscribe() {<br>    @Override<br>    public void subscribe(ObservableEmitter e) throws Exception {<br>        e.onNext(“Hello World!”);<br>    }<br>});</p>
<p>observable.subscribe(observer);</p>
<p>这是一个非常简单的例子，由于1.x中Observable不能合理的背压，导致了无法意料的 MissingBackpressureException，所以在2.x中，添加了Flowable来支持背压，而把Observable设计成非背压的。<br>还有一点需要注意的就是，在上边注释中也有，onSubscribe(Disposable d)这个回调方法是在2.x中添加的，Dispose参数是由1.x中的Subscription改名的，为了避免名称冲突！<br>所以上边的例子在2.x中，最好这么写：</p>
<p>//创建订阅者<br>Subscriber<string> subscriber = new Subscriber<string>() {<br>    @Override<br>    public void onSubscribe(Subscription s) {<br>    //这一步是必须，我们通常可以在这里做一些初始化操作，调用request()方法表示初始化工作已经完成<br>    //调用request()方法，会立即触发onNext()方法<br>    //在onComplete()方法完成，才会再执行request()后边的代码<br>    s.request(Long.MAX_VALUE);<br>    }</string></string></p>
<pre><code>@Override
public void onNext(String value) {
    Log.e(&quot;onNext&quot;, value);
}

@Override
public void onError(Throwable t) {
    Log.e(&quot;onError&quot;, t.getMessage());
}

@Override
public void onComplete() {
//由于Reactive-Streams的兼容性，方法onCompleted被重命名为onComplete
    Log.e(&quot;onComplete&quot;, &quot;complete&quot;);
}
</code></pre><p>};</p>
<p>Flowable.create(new FlowableOnSubscribe<string>() {<br>    @Override<br>    public void subscribe(FlowableEmitter<string> e) throws Exception {<br>        e.onNext(“Hello,I am China!”);<br>    }<br>}, BackpressureStrategy.BUFFER)<br>    .subscribe(subscriber);     </string></string></p>
<p>在2.x中，我们在onSubscribe()回调中必须调用s.request()方法去请求资源，参数就是要请求的数量，一般如果不限制请求数量，可以写成Long.MAX_VALUE，之后会立即触发onNext()方法！所以当你在onSubscribe()/onStart()中做了一些初始化的工作，而这些工作是在request()后面时，会出现一些问题，在onNext()执行时，你的初始化工作的那部分代码还没有执行。为了避免这种情况，请确保你调用request()时，已经把所有初始化工作做完了。</p>
<p>更简洁的写法</p>
<p>Flowable.just(“Hello,I am China!”)<br>    .subscribe(subscriber);<br>    //.subscribeWith(subscriber)//在1.x中此方法返回Subscription，而在2.x中是没有返回值的<br>    //所以增加subscribeWith()方法，用来返回一个Disposable对象<br>    //使得用户可以CompositeDisposable.add()方法添加对象。1.x为CompositeSubscription<br>    //其他subscribe()重载方法返回Disposable</p>
<p>RxJava提供了just()方法来创建一个发射字符串的Flowable，然后调用subcribe()即可！<br>这里还有一个需要注意的问题，就是在注释中写的subcribe()方法有多种重载方法，只有subscribe(subscriber)这个重载方法时没有返回值的，但是在1.x中，此方法返回Subscription（上边也提到过，在2.x中改名为Disposable），用户经常添加Subscription到CompositeSubscription（2.x中改名为CompositeDisposable），为了弥补这一点，我们增加了E subscribeWith(E subscriber)方法，返回一个Disposable对象，使得用户可以CompositeDisposable.add()方法添加对象。</p>
<p>而对于 Subscriber 来说，我们目前仅仅关心onNext方法。所以又可以这样写：</p>
<p>Flowable.just(“Hello,I am China!”)<br>    //替代1.x中的action1,接收一个参数，如果是两个参数action2使用BiCustomer，而且删除了action3-9<br>    //多个参数用Custom<object[]><br>    .subscribe(new Consumer<string>() {<br>        @Override<br>        public void accept(String s) throws Exception {<br>            Log.e(“consumer”, s);<br>        }<br>    });</string></object[]></p>
<p>需要注意的问题：在1.x的API中，这里是Action1，在2.x中使用Consumer来代替，如果是两个参数，则用BiConsumer来代替Action2，而且在2.x中删除了Action3-9，如果是多个参数则用Custom<object[]>代替ActionN。</object[]></p>
<p>RxJava还有一个API能达到类似的效果，就是from()，但是因为在使用java8编译时，javac不能够区分功能接口类型，所以它在2.x中被拆分为：fromArray,fromIterable,fromFuture<br>所以上边又可以这样写：</p>
<p>Flowable.fromArray(“Hello,I am China!”)<br>    .subscribe(new Consumer<string>() {<br>        @Override<br>        public void accept(String s) throws Exception {<br>            Log.e(“consumer”, s);<br>        }<br>        });</string></p>
<p>操作符</p>
<p>map</p>
<p>首先看一个map的例子</p>
<p>Flowable.just(“Hello,I am China!”)<br>    //将1.x中的Func1,2改为Function和BiFunction，Func3-9改为Function3-9<br>    //多参数FuncN改为Function<object[],r></object[],r></p>
<pre><code>//这个第一个泛型为接收参数的数据类型，第二个泛型为转换后要发射的数据类型
.map(new Function&lt;String, String&gt;() {
    @Override
    public String apply(String s) throws Exception {
        return s+&quot;__by Mars&quot;;
    }
})
.subscribe(new Consumer&lt;String&gt;() {
    @Override
    public void accept(String s) throws Exception {
        Log.e(&quot;consumer&quot;, s);
    }
});*/
</code></pre><p>可以看出，例子中map()将一个字符串对象，转换为另一个字符串对象返回，当然我们也可以将其转换为与之不同的对象，对应的返回的Flowable对象参数也会变为转换后的对象。另外Function的泛型第一个为接收参数的数据类型，第二个为转换后要发射的数据类型。<br>需要注意的问题：在2.x中将1.x的Func1和Func2改为Function和BiFunction，Func3-9改为Function3-9，多参数FuncN改为Function<object[],r></object[],r></p>
<p>map()的逻辑操作图：<br>这里写图片描述</p>
<p>flatMap</p>
<p>首先看一个例子：</p>
<p>ArrayList<string[]> list=new ArrayList&lt;&gt;();<br>String[] words1={“Hello,”,”I am”,”China!”};<br>String[] words2={“Hello,”,”I am”,”Beijing!”};<br>list.add(words1);<br>list.add(words2);<br>Flowable.fromIterable(list)<br>    .flatMap(new Function<string[], publisher<string="">&gt;() {<br>        @Override<br>        public Publisher<string> apply(String[] strings) throws Exception {<br>            return Flowable.fromArray(strings);<br>        }<br>    })<br>    .subscribe(new Consumer<string>() {<br>        @Override<br>        public void accept(String s) throws Exception {<br>            Log.e(“consumer”, s);<br>        }<br>    });</string></string></string[],></string[]></p>
<p>从上边这个例子可以看出，flatMap和map还是有共同点的，都是将一个对象转换为另一个对象，不同的是map只是一对一的转换，而flatMap可以是一对多的转换，并且是转换为另外一个Flowable对象！</p>
<p>flatMap()的逻辑操作图：<br>这里写图片描述</p>
<p>lift和compose</p>
<p>关于这些转换的使用和原理，可以参考扔物线的<br>给 Android 开发者的 RxJava 详解<br>2.x中的用法基本相同</p>
<p>concat和merge</p>
<p>concat</p>
<p>逻辑操作图：<br>这里写图片描述</p>
<p>merge</p>
<p>逻辑操作图：<br>这里写图片描述</p>
<p>上述所有逻辑操作图来自这里</p>
<p>其他api</p>
<p>Flowable.range(5,10)//从5开始数10个数(5——14)<br>    .filter(new Predicate<integer>() {//过滤为偶数<br>        @Override<br>        public boolean test(Integer integer) throws Exception {<br>            return integer%2==0;<br>        }<br>    })<br>    .take(2)//只要前2个数据<br>    .subscribe(new Consumer<integer>() {<br>        @Override<br>        public void accept(Integer integer) throws Exception {<br>            Log.e(“consumer”, integer+””);<br>        }<br>    });</integer></integer></p>
<p>上边注释已经写的很清楚了！<br>range()方法，第一个参数为开始值，第二个参数为数量，所以别搞错了，以为第二个参数为结束值；filter()方法用于对数据进行过滤；take(n)方法用于取前n个值。</p>
<p>在Android中的使用</p>
<p>RxJava在android中的使用，主要就体现在异步这一点。对应RxJava，RxAndroid也已经到2.x版本。<br>我在上一篇博客中也提到过，涉及两个比较核心的方法subscribeOn和observeOn这两个方法都传入一个Scheduler对象，subscribeOn指定发射事件的线程，observeOn指定消费事件的线程。<br>在2.x的API中仍然支持主要的默认scheduler: computation, io, newThread 和 trampoline，可以通过io.reactivex.schedulers.Schedulers这个实用的工具类来调度。</p>
<p>我们在android中主要就使用下边这两个就够了：<br>①Schedulers.io(): I/O 操作（读写文件、读写数据库、网络信息交互等）所使用的 Scheduler。行为模式和 newThread() 差不多，区别在于 io() 的内部实现是是用一个无数量上限的线程池，可以重用空闲的线程，因此多数情况下 io() 比 newThread() 更有效率。不要把计算工作放在 io() 中，可以避免创建不必要的线程。<br>②AndroidSchedulers.mainThread()，它指定的操作将在 Android 主线程运行。</p>
<p>这里一个最简单的例子：</p>
<p>Flowable.just(“Hello,I am China!”)<br>    .subscribeOn(Schedulers.io())<br>    .observeOn(AndroidSchedulers.mainThread())<br>    .subscribe(subscriber)</p>
<p>所以在Android中创建Flowable时，即发射数据源的时候的耗时操作，可以指定在io()线程中，得到数据后，更新UI可以指定在mainThread()中。</p>
<p>当然现在最经典的就是RxAndroid和Retrofit的结合使用了：<br>这里有一个比较牛逼的写法总结：<br>RxJava 与 Retrofit 结合的最佳实践<br>这篇文章是基于1.x写的，不过在2.x中用法大同小异。<br>另外需要注意的问题就是，retrofit现在还未支持RxJava2.x，不过不用担心，jake大神已经给我们写好了适配器：</p>
<p>compile ‘com.jakewharton.retrofit:retrofit2-rxjava2-adapter:1.0.0’<br>1<br>在gradle中添加依赖即可！<br>然后在创建Retrofit对象时，这样写：</p>
<p>Retrofit retrofit = new Retrofit.Builder()<br>    .baseUrl(BASE_URL)<br>    .addConverterFactory(GsonConverterFactory.create())<br>    .addCallAdapterFactory(RxJava2CallAdapterFactory.create())//1.X为RxJavaCallAdapterFactory<br>    .build();</p>
<p>就可以在Retrofit2中尽情使用RxJava2了！</p>
<p>好了，先这样吧，上边就是RxJava涉及到的比较基础的东西！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://michealwu.tech/blog/first/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michealwu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Michealwu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/first/" itemprop="url">我的第一篇博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-06T09:42:50+08:00">
                2018-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>你好，欢迎来到我的个人技术博客，这是我第一次开始弄自己的blog(利用Hexo开源框架搭建的blog)，从2018年1月1日起，以后我所有的技术blog都会写到这个博客中，谢谢大家关注。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Michealwu</p>
              <p class="site-description motion-element" itemprop="description">追求卓越无止境,勿忌别人品头足</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Michealwu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
